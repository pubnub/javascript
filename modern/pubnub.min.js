// Version: 3.5.48
(function(){
var ca=1,r=!1,u=[],D="-pnpres",da=10,ea=310,fa=60,L=1E3,ga="/",ha="&",ia=/{([\w\-]+)}/g;function ja(){return"x"+ ++ca+""+ +new Date}function O(){return+new Date}var Q=function(){var c=Math.floor(20*Math.random());return function(d,e){return 0<d.indexOf("pubsub.")&&d.replace("pubsub","ps"+(e?P().split("-")[0]:20>++c?c:c=1))||d}}();
function ka(c,d){var e=c.join(ga),a=[];if(!d)return e;T(d,function(c,d){"undefined"!=typeof d&&null!=d&&0<encodeURIComponent(d).length&&a.push(c+"="+encodeURIComponent(d))});return e+="?"+a.join(ha)}function la(c,d){function e(){f+d>O()?(clearTimeout(a),a=setTimeout(e,d)):(f=O(),c())}var a,f=0;return e}function ma(c,d){var e=[];T(c||[],function(a){d(a)&&e.push(a)});return e}function na(c,d){return c.replace(ia,function(c,a){return d[a]||c})}function X(c,d){return setTimeout(c,d)}
function P(c){var d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var a=16*Math.random()|0;return("x"==c?a:a&3|8).toString(16)});c&&c(d);return d}function T(c,d){if(c&&d)if("undefined"!=typeof c[0])for(var e=0,a=c.length;e<a;)d.call(c[e],c[e],e++);else for(e in c)c.hasOwnProperty&&c.hasOwnProperty(e)&&d.call(c[e],e,c[e])}function Y(c,d){var e=[];T(c||[],function(a,c){e.push(d(a,c))});return e}function Z(c){var d=[];T(c,function(c,a){a.i&&d.push(c)});return d.sort()}
function oa(){X(function(){r||(r=1,T(u,function(c){c()}))},L)}
function pa(c){function d(){}function e(b){if(qa){if(!n.length)return}else{b&&(n.g=0);if(n.g||!n.length)return;n.g=1}v(n.shift())}function a(b){var c=0;T(Z(z),function(a){if(a=z[a])c++,(b||function(){})(a)});return c}function f(){ra()||A(1,{error:"Offline. Please check your network settings. "});setTimeout(f,L)}function y(){s.time(function(b){E(function(){},b);b||A(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."});setTimeout(y,F)})}function A(b,a){G&&G(b,
a);G=null}function E(b,a){function c(a){a&&(U=O()-(a/1E4+(O()-h)/2),b&&b(U))}var h=O();a&&c(a)||s.time(c)}var H=+c.windowing||da,V=(+c.timeout||ea)*L,F=(+c.keepalive||fa)*L,I=c.noleave||0,k=c.publish_key||"demo",h=c.subscribe_key||"demo",q=c.auth_key||"",g=c.secret_key||"",M=c.PNSDK||"",t=c.hmac_SHA256,B=c.ssl?"s":"",N="http"+B+"://"+(c.origin||"pubsub.pubnub.com"),w=Q(N),$=Q(N),n=[],U=0,aa=0,ba=0,G=0,W=0,J=0,z={},qa=c.no_wait_for_pending,v=c.xdr,m=c.error||function(){},ra=c._is_online||function(){return 1},
C=c.jsonp_cb||function(){return 0},K=c.db||{get:function(){},set:function(){}},x=c.uuid||K&&K.get(h+"uuid")||"",s={LEAVE:function(b,a,c,d){var k={uuid:x,auth:q},e=Q(N);c=c||function(){};var g=d||function(){};d=C();if(0<b.indexOf(D))return!0;if(I||!B||"0"==d)return!1;"0"!=d&&(k.callback=d);v({j:a||B,timeout:2E3,a:d,data:k,c:function(b){"object"==typeof b&&b.error?g(b):c(b)},b:g,url:[e,"v2","presence","sub_key",h,"channel",encodeURIComponent(b),"leave"]});return!0},history:function(b,a){a=b.callback||
a;var c=b.count||b.limit||100,d=b.reverse||"false",k=b.error||function(){},e=b.auth_key||q,g=b.channel,l=b.start,S=b.end,f={},p=C();if(!g)return m("Missing Channel");if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");f.stringtoken="true";f.count=c;f.reverse=d;f.auth=e;p&&(f.callback=p);l&&(f.start=l);S&&(f.end=S);v({a:p,data:f,c:function(b){"object"==typeof b&&b.error?k(b):a(b)},b:k,url:[w,"v2","history","sub-key",h,"channel",encodeURIComponent(g)]})},replay:function(b){var a=
a||b.callback||function(){},c=b.auth_key||q,d=b.source,e=b.destination,g=b.stop,f=b.start,l=b.end,S=b.reverse;b=b.limit;var t=C(),p={};if(!d)return m("Missing Source Channel");if(!e)return m("Missing Destination Channel");if(!k)return m("Missing Publish Key");if(!h)return m("Missing Subscribe Key");"0"!=t&&(p.callback=t);g&&(p.stop="all");S&&(p.reverse="true");f&&(p.start=f);l&&(p.end=l);b&&(p.count=b);p.auth=c;v({a:t,c:function(b){"object"==typeof b&&b.error?err(b):a(b)},b:function(){a([0,"Disconnected"])},
url:[w,"v1","replay",k,h,d,e],data:p})},auth:function(b){q=b;d()},time:function(b){var a=C();v({a:a,data:{uuid:x,auth:q},timeout:5*L,url:[w,"time",a],c:function(a){b(a[0])},b:function(){b(0)}})},publish:function(b,a){a=a||b.callback||function(){};var c=b.message,d=b.channel,g=b.auth_key||q,f=b.error||function(){},R=C(),l="push";b.prepend&&(l="unshift");if(!c)return m("Missing Message");if(!d)return m("Missing Channel");if(!k)return m("Missing Publish Key");if(!h)return m("Missing Subscribe Key");
c=JSON.stringify(c);n[l]({a:R,timeout:5*L,url:[w,"publish",k,h,0,encodeURIComponent(d),R,encodeURIComponent(c)],data:{uuid:x,auth:g},b:function(b){f(b);e(1)},c:function(b){"object"==typeof b&&b.error?f(b):a(b);e(1)}});e()},unsubscribe:function(b,a){var c=b.channel;a=a||b.callback||function(){};var h=b.error||function(){};J=0;W=1;c=Y((c.join?c.join(","):""+c).split(","),function(b){if(z[b])return b+","+b+D}).join(",");T(c.split(","),function(b){var c=!0;b&&(r&&(c=s.LEAVE(b,0,a,h)),c||a({action:"leave"}),
z[b]=0)});d()},subscribe:function(b,c){function k(b){b?setTimeout(d,L):(w=Q(N,1),$=Q(N,1),X(function(){s.time(k)},L));a(function(a){if(b&&a.d)return a.d=0,a.l(a.name);b||a.d||(a.d=1,a.disconnect(a.name))})}function e(){var b=C(),c=Z(z).join(",");c&&(A(),G=v({timeout:E,a:b,b:function(b){M(b);G=null;s.time(k)},data:{uuid:x,auth:f},url:[$,"subscribe",h,encodeURIComponent(c),b,J],c:function(b){G=null;if(!b||"object"==typeof b&&"error"in b&&b.error)return M(b),setTimeout(d,L);p(b[1]);J=!J&&W&&K.get(h)||
b[1];a(function(b){b.f||(b.f=1,b.k(b.name))});B&&(J=1E4,B=0);K.set(h,b[1]);var c=function(){var a=(2<b.length?b[2]:Y(z,function(a){return Y(Array(b[0].length).join(",").split(","),function(){return a})}).join(",")).split(",");return function(){var b=a.shift()||ba;return[(z[b]||{}).a||aa,b.split(D)[0]]}}(),k=O()-U-+b[1]/1E4;T(b[0],function(a){var h=c();h[0](a,b,h[1],k)});setTimeout(e,I)}}))}var g=b.channel;c=(c=c||b.callback)||b.message;var f=b.auth_key||q,R=b.connect||function(){},l=b.reconnect||
function(){},t=b.disconnect||function(){},M=b.error||function(){},p=b.idle||function(){},n=b.presence||0,y=b.noheresync||0,B=b.backfill||0,F=b.timetoken||0,E=b.timeout||V,I=b.windowing||H;W=b.restore;J=F;if(!g)return m("Missing Channel");if(!c)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");T((g.join?g.join(","):""+g).split(","),function(b){var a=z[b]||{};z[ba=b]={name:b,f:a.f,d:a.d,i:1,a:aa=c,k:R,disconnect:t,l:l};n&&(s.subscribe({channel:b+D,callback:n}),a.i||y||s.here_now({channel:b,
callback:function(a){T("uuids"in a?a.uuids:[],function(c){n({action:"join",uuid:c,timestamp:O(),occupancy:a.occupancy||1},a,b)})}}))});d=function(){A();setTimeout(e,I)};if(!r)return u.push(d);d()},here_now:function(b,a){a=b.callback||a;var c=b.error||function(){},d=b.auth_key||q,k=b.channel,g=C(),d={uuid:x,auth:d};if(!k)return m("Missing Channel");if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");"0"!=g&&(d.callback=g);v({a:g,data:d,c:function(b){"object"==typeof b&&b.error?
c(b):a(b)},b:c,url:[w,"v2","presence","sub_key",h,"channel",encodeURIComponent(k)]})},grant:function(b,a){a=b.callback||a;var c=b.error||function(){},d=b.channel,e=C(),f=b.ttl||-1,q=b.read?"1":"0",l=b.write?"1":"0",n=b.auth_key;if(!d)return m("Missing Channel");if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");if(!k)return m("Missing Publish Key");if(!g)return m("Missing Secret Key");var s=Math.floor((new Date).getTime()/1E3),p=t(h+"\n"+k+"\ngrant\n"+(n&&0<encodeURIComponent(n).length?
"auth="+encodeURIComponent(n)+"&":"")+"channel="+encodeURIComponent(d)+"&pnsdk="+encodeURIComponent(M)+"&r="+q+"&timestamp="+encodeURIComponent(s)+(-1<f?"&ttl="+f:"")+"&w="+l,g),p=p.replace(/\+/g,"-"),p=p.replace(/\//g,"_"),d={w:l,r:q,signature:p,channel:encodeURIComponent(d),timestamp:s};"0"!=e&&(d.callback=e);-1<f&&(d.ttl=f);n&&(d.auth=encodeURIComponent(n));v({a:e,data:d,c:function(b){a(b)},b:c,url:[w,"v1","auth","grant","sub-key",h]})},audit:function(b,a){a=b.callback||a;var c=b.error||function(){},
d=b.channel,e=b.auth_key,f=C();if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");if(!k)return m("Missing Publish Key");if(!g)return m("Missing Secret Key");var q=Math.floor((new Date).getTime()/1E3),l=h+"\n"+k+"\naudit\n";e&&(l+="auth="+encodeURIComponent(e)+"&");d&&(l+="channel="+encodeURIComponent(d)+"&");l+="pnsdk="+encodeURIComponent(M)+"&timestamp="+q;l=t(l,g);l=l.replace(/\+/g,"-");l=l.replace(/\//g,"_");q={signature:l,timestamp:q};"0"!=f&&(q.callback=f);d&&(q.channel=
encodeURIComponent(d));e&&(q.auth=encodeURIComponent(e));v({a:f,data:q,c:function(b){a(b)},b:c,url:[w,"v1","auth","audit","sub-key",h]})},revoke:function(b,a){b.read=!1;b.write=!1;s.grant(b,a)},set_uuid:function(b){x=b;d()},get_uuid:function(){return x},xdr:v,ready:oa,db:K,uuid:P,map:Y,each:T,"each-channel":a,grep:ma,offline:function(){A(1)},supplant:na,now:O,unique:ja,updater:la};x||(x=s.uuid());K.set(h+"uuid",x);setTimeout(f,L);setTimeout(y,F);E();return s}
(function(){function c(a){function d(a,c){f||(f=1,clearTimeout(B),g&&(g.onerror=g.onload=null,g.abort&&g.abort(),g=null),a&&w(c))}function e(){if(!t){t=1;clearTimeout(B);try{response=JSON.parse(g.responseText)}catch(a){return d(1)}A(response)}}var g,f=0,t=0,B=X(function(){d(1)},F),y=a.data||{},w=a.b||function(){},A=a.c||function(){},n="undefined"===typeof a.j;try{g="undefined"!==typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest,g.onerror=g.onabort=function(){d(1,g.responseText||{error:"Network Connection Error"})},
g.onload=g.onloadend=e,g.onreadystatechange=function(){if(4==g.readyState)switch(g.status){case 401:case 402:case 403:try{response=JSON.parse(g.responseText),d(1,response)}catch(a){return d(1,g.responseText)}}},n&&(g.timeout=F),y.pnsdk=V,url=ka(a.url,y),g.open("GET",url,n),g.send()}catch(E){return d(0),c(a)}return d}function d(a,c,d){T(a.split(","),function(a){function e(a){a||(a=window.event);d(a)||(a.cancelBubble=!0,a.returnValue=!1,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}
c.addEventListener?c.addEventListener(a,e,!1):c.attachEvent?c.attachEvent("on"+a,e):c["on"+a]=e})}function e(a){console.error(a)}function a(a,c,d){if(d)a.setAttribute(c,d);else return a&&a.getAttribute&&a.getAttribute(c)}function f(a){return document.getElementById(a)}function y(a,c){var d=[];T(a.split(/\s+/),function(a){T((c||document).getElementsByTagName(a),function(a){d.push(a)})});return d}function A(a,c){for(var d in c)if(c.hasOwnProperty(d))try{a.style[d]=c[d]+(0<"|width|height|top|left|".indexOf(d)&&
"number"==typeof c[d]?"px":"")}catch(e){}}function E(a){return document.createElement(a)}function H(k){k.db=I;k.xdr=c;k.error=e;var h=pa(k);h.init=H;h.$=f;h.attr=a;h.search=y;h.bind=d;h.css=A;h.create=E;d("beforeunload",window,function(){h["each-channel"](function(a){h.LEAVE(a.name,1)});return!0});if(k.notest)return h;d("offline",window,h._reset_offline);d("offline",document,h._reset_offline);h.ready();return h}var V="PubNub-JS-Modern/3.5.48",F=31E4,I=function(){var a="undefined"!=typeof localStorage&&
localStorage;return{get:function(c){try{return a?a.getItem(c):-1==document.cookie.indexOf(c)?null:((document.cookie||"").match(RegExp(c+"=([^;]+)"))||[])[1]||null}catch(d){}},set:function(c,d){try{if(a)return a.setItem(c,d)&&0;document.cookie=c+"="+d+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(e){}}}}();"undefined"!==typeof module&&(module.n=H)||"undefined"!==typeof exports&&(exports.m=H)||(PUBNUB=H)})();
(function(){var c=PUBNUB.ws=function(d,e){if(!(this instanceof c))return new c(d,e);var a=this;d=a.url=d||"";a.protocol=e||"Sec-WebSocket-Protocol";var f=d.split("/"),f={ssl:"wss:"===f[0],origin:f[2],publish_key:f[3],subscribe_key:f[4],channel:f[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=
a.onsend=function(){};a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=!1;a.buffer=[];a.readyState=a.CONNECTING;if(!d)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),a;a.e=PUBNUB.init(f);a.e.h=f;a.h=f;a.e.subscribe({restore:!1,channel:f.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(c){a.onmessage({data:c})},connect:function(){a.readyState=
a.OPEN;a.onopen()}})};c.prototype.send=function(c){var e=this;e.e.publish({channel:e.e.h.channel,message:c,callback:function(a){e.onsend({data:a})}})}})();
})();
