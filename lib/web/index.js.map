{"version":3,"sources":["web/index.js"],"names":["sendBeacon","url","navigator","setup","listenToBrowserNetworkEvents","db","sdkFamily","networking","Networking","del","get","post","window","addEventListener","networkDownDetected","networkUpDetected","PubNubCore"],"mappings":";;;;;;AAGA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;AAEA,SAASA,UAAT,CAAoBC,GAApB,EAAiC;AAC/B,MAAIC,aAAaA,UAAUF,UAA3B,EAAuC;AACrCE,cAAUF,UAAV,CAAqBC,GAArB;AACD,GAFD,MAEO;AACL,WAAO,KAAP;AACD;AACF;;;;;AAGC,kBAAYE,KAAZ,EAAwC;AAAA;;AAAA,gCAEUA,KAFV,CAE9BC,4BAF8B;AAAA,QAE9BA,4BAF8B,yCAEC,IAFD;;;AAItCD,UAAME,EAAN,GAAWA,aAAX;AACAF,UAAMG,SAAN,GAAkB,KAAlB;AACAH,UAAMI,UAAN,GAAmB,IAAIC,oBAAJ,CAAe,EAAEC,iBAAF,EAAOC,iBAAP,EAAYC,mBAAZ,EAAkBX,sBAAlB,EAAf,CAAnB;;AANsC,gHAQhCG,KARgC;;AAUtC,QAAIC,4BAAJ,EAAkC;AAEhCQ,aAAOC,gBAAP,CAAwB,SAAxB,EAAmC,YAAM;AACvC,cAAKC,mBAAL;AACD,OAFD;;AAIAF,aAAOC,gBAAP,CAAwB,QAAxB,EAAkC,YAAM;AACtC,cAAKE,iBAAL;AACD,OAFD;AAGD;AAnBqC;AAoBvC;;;EArB0BC,sB","file":"index.js","sourcesContent":["/* @flow */\r\n/* global navigator, window */\r\n\r\nimport PubNubCore from '../core/pubnub-common';\r\nimport Networking from '../networking';\r\nimport db from '../db/web';\r\nimport { del, get, post } from '../networking/modules/web-node';\r\nimport { InternalSetupStruct } from '../core/flow_interfaces';\r\n\r\nfunction sendBeacon(url: string) {\r\n  if (navigator && navigator.sendBeacon) {\r\n    navigator.sendBeacon(url);\r\n  } else {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport default class extends PubNubCore {\r\n  constructor(setup: InternalSetupStruct) {\r\n    // extract config.\r\n    const { listenToBrowserNetworkEvents = true } = setup;\r\n\r\n    setup.db = db;\r\n    setup.sdkFamily = 'Web';\r\n    setup.networking = new Networking({ del, get, post, sendBeacon });\r\n\r\n    super(setup);\r\n\r\n    if (listenToBrowserNetworkEvents) {\r\n      // mount network events.\r\n      window.addEventListener('offline', () => {\r\n        this.networkDownDetected();\r\n      });\r\n\r\n      window.addEventListener('online', () => {\r\n        this.networkUpDetected();\r\n      });\r\n    }\r\n  }\r\n\r\n}\r\n"]}