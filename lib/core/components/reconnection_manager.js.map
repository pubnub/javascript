{"version":3,"sources":["core/components/reconnection_manager.js"],"names":["timeEndpoint","_timeEndpoint","reconnectionCallback","_reconnectionCallback","_timeTimer","setInterval","_performTimeLoop","bind","clearInterval","status","error"],"mappings":";;;;;;;;;;;;;;;AAAA;;AACA;;;AAWE,0BAAuD;AAAA,QAAzCA,YAAyC,QAAzCA,YAAyC;AAAA;AAAA;AAAA;AAAA;AACrD,SAAKC,aAAL,GAAqBD,YAArB;AACD;;;;WAED,wBAAeE,oBAAf,EAA+C;AAC7C,WAAKC,qBAAL,GAA6BD,oBAA7B;AACD;;;WAED,wBAAe;AACb,WAAKE,UAAL,GAAkBC,WAAW,CAAC,KAAKC,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAAD,EAAmC,IAAnC,CAA7B;AACD;;;WAED,uBAAc;AACZC,MAAAA,aAAa,CAAC,KAAKJ,UAAN,CAAb;AACD;;;WAED,4BAAmB;AAAA;;AACjB,WAAKH,aAAL,CAAmB,UAACQ,MAAD,EAAgC;AACjD,YAAI,CAACA,MAAM,CAACC,KAAZ,EAAmB;AACjBF,UAAAA,aAAa,CAAC,KAAI,CAACJ,UAAN,CAAb;;AACA,UAAA,KAAI,CAACD,qBAAL;AACD;AACF,OALD;AAMD","sourcesContent":["import TimeEndpoint from '../endpoints/time';\nimport { StatusAnnouncement } from '../flow_interfaces';\n\ntype ReconnectionManagerArgs = {\n  timeEndpoint: TimeEndpoint\n}\n\nexport default class {\n  _reconnectionCallback: Function;\n  _timeEndpoint: TimeEndpoint;\n  _timeTimer: number;\n\n  constructor({ timeEndpoint }: ReconnectionManagerArgs) {\n    this._timeEndpoint = timeEndpoint;\n  }\n\n  onReconnection(reconnectionCallback: Function) {\n    this._reconnectionCallback = reconnectionCallback;\n  }\n\n  startPolling() {\n    this._timeTimer = setInterval(this._performTimeLoop.bind(this), 3000);\n  }\n\n  stopPolling() {\n    clearInterval(this._timeTimer);\n  }\n\n  _performTimeLoop() {\n    this._timeEndpoint((status: StatusAnnouncement) => {\n      if (!status.error) {\n        clearInterval(this._timeTimer);\n        this._reconnectionCallback();\n      }\n    });\n  }\n}\n"],"file":"reconnection_manager.js"}