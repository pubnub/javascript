{"version":3,"sources":["core/components/reconnection_manager.js"],"names":["timeEndpoint","_timeEndpoint","reconnectionCallback","_reconnectionCallback","_timeTimer","setInterval","_performTimeLoop","bind","clearInterval","status","error"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;AAYE,wBAAuD;AAAA,QAAzCA,YAAyC,QAAzCA,YAAyC;;AAAA;;AACrD,SAAKC,aAAL,GAAqBD,YAArB;AACD;;;;mCAEcE,oB,EAAgC;AAC7C,WAAKC,qBAAL,GAA6BD,oBAA7B;AACD;;;mCAEc;AACb,WAAKE,UAAL,GAAkBC,YAAY,KAAKC,gBAAL,CAAsBC,IAAtB,CAA2B,IAA3B,CAAZ,EAA8C,IAA9C,CAAlB;AACD;;;kCAEa;AACZC,oBAAc,KAAKJ,UAAnB;AACD;;;uCAEkB;AAAA;;AACjB,WAAKH,aAAL,CAAmB,UAACQ,MAAD,EAAgC;AACjD,YAAI,CAACA,OAAOC,KAAZ,EAAmB;AACjBF,wBAAc,MAAKJ,UAAnB;AACA,gBAAKD,qBAAL;AACD;AACF,OALD;AAMD","file":"reconnection_manager.js","sourcesContent":["import TimeEndpoint from '../endpoints/time';\r\nimport { StatusAnnouncement } from '../flow_interfaces';\r\n\r\ntype ReconnectionManagerArgs = {\r\n  timeEndpoint: TimeEndpoint\r\n}\r\n\r\nexport default class {\r\n\r\n  _reconnectionCallback: Function;\r\n  _timeEndpoint: TimeEndpoint;\r\n  _timeTimer: number;\r\n\r\n  constructor({ timeEndpoint }: ReconnectionManagerArgs) {\r\n    this._timeEndpoint = timeEndpoint;\r\n  }\r\n\r\n  onReconnection(reconnectionCallback: Function) {\r\n    this._reconnectionCallback = reconnectionCallback;\r\n  }\r\n\r\n  startPolling() {\r\n    this._timeTimer = setInterval(this._performTimeLoop.bind(this), 3000);\r\n  }\r\n\r\n  stopPolling() {\r\n    clearInterval(this._timeTimer);\r\n  }\r\n\r\n  _performTimeLoop() {\r\n    this._timeEndpoint((status: StatusAnnouncement) => {\r\n      if (!status.error) {\r\n        clearInterval(this._timeTimer);\r\n        this._reconnectionCallback();\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n"]}