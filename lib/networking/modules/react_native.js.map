{"version":3,"sources":["networking/modules/react_native.js"],"names":["get","post","del","log","url","qs","res","_pickLogger","console","start","Date","getTime","timestamp","toISOString","logger","now","elapsed","timestampDone","xdr","method","params","body","endpoint","callback","status","operation","fetch","then","response","error","statusCode","json","resp","_config","logVerbosity","catch","e","errorData","category","_detectErrorCategory","getStandardOrigin","call"],"mappings":"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","file":"react_native.js","sourcesContent":["/* @flow */\r\n/* global console */\r\n\r\nimport { EndpointDefinition, StatusAnnouncement } from '../../core/flow_interfaces';\r\nimport { buildUrl } from '../utils';\r\n\r\ndeclare var fetch: any;\r\n\r\nfunction log(url, qs, res) {\r\n  let _pickLogger = () => {\r\n    if (console && console.log) return console; // eslint-disable-line no-console\r\n    return console;\r\n  };\r\n\r\n  let start = new Date().getTime();\r\n  let timestamp = new Date().toISOString();\r\n  let logger = _pickLogger();\r\n  logger.log('<<<<<');                                               // eslint-disable-line no-console\r\n  logger.log(`[${timestamp}]`, '\\n', url, '\\n', qs);    // eslint-disable-line no-console\r\n  logger.log('-----');                                               // eslint-disable-line no-console\r\n\r\n  let now = new Date().getTime();\r\n  let elapsed = now - start;\r\n  let timestampDone = new Date().toISOString();\r\n\r\n  logger.log('>>>>>>');                                                                                  // eslint-disable-line no-console\r\n  logger.log(`[${timestampDone} / ${elapsed}]`, '\\n', url, '\\n', qs, '\\n', res);  // eslint-disable-line no-console\r\n  logger.log('-----');\r\n}\r\n\r\nfunction xdr(method: string, url: string, params: Object, body: string, endpoint: EndpointDefinition, callback: Function): void {\r\n  let status: StatusAnnouncement = {};\r\n  status.operation = endpoint.operation;\r\n\r\n  fetch(buildUrl(url, params), { method, body })\r\n    .then((response) => {\r\n      status.error = false;\r\n\r\n      if (response.status) {\r\n        status.statusCode = response.status;\r\n      }\r\n\r\n      return response.json();\r\n    })\r\n    .then((response) => {\r\n      let resp = response;\r\n\r\n      if (this._config.logVerbosity) {\r\n        log(url, params, resp);\r\n      }\r\n\r\n      callback(status, resp);\r\n    })\r\n    .catch((e) => {\r\n      status.error = true;\r\n      status.errorData = e.error;\r\n      status.category = this._detectErrorCategory(e.error);\r\n      callback(status, null);\r\n    });\r\n}\r\n\r\nexport function get(params: Object, endpoint: EndpointDefinition, callback: Function) {\r\n  let url = this.getStandardOrigin() + endpoint.url;\r\n\r\n  return xdr.call(this, 'GET', url, params, '', endpoint, callback);\r\n}\r\n\r\nexport function post(params: Object, body: string, endpoint: EndpointDefinition, callback: Function) {\r\n  let url = this.getStandardOrigin() + endpoint.url;\r\n\r\n  return xdr.call(this, 'POST', url, params, body, endpoint, callback);\r\n}\r\n\r\nexport function del(params: Object, endpoint: EndpointDefinition, callback: Function) {\r\n  let url = this.getStandardOrigin() + endpoint.url;\r\n\r\n  return xdr.call(this, 'DELETE', url, params, '', endpoint, callback);\r\n}\r\n"]}