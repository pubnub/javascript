// Version: 3.5.48
(function(){
var ba=1,s=!1,v=[],D="-pnpres",ca=10,da=310,ea=60,M=1E3,fa="/",ga="&",ha=/{([\w\-]+)}/g;function ia(){return"x"+ ++ba+""+ +new Date}function O(){return+new Date}var Q=function(){var c=Math.floor(20*Math.random());return function(d,e){return 0<d.indexOf("pubsub.")&&d.replace("pubsub","ps"+(e?P().split("-")[0]:20>++c?c:c=1))||d}}();
function ja(c,d){var e=c.join(fa),a=[];if(!d)return e;S(d,function(c,d){"undefined"!=typeof d&&null!=d&&0<encodeURIComponent(d).length&&a.push(c+"="+encodeURIComponent(d))});return e+="?"+a.join(ga)}function ka(c,d){function e(){f+d>O()?(clearTimeout(a),a=setTimeout(e,d)):(f=O(),c())}var a,f=0;return e}function la(c,d){var e=[];S(c||[],function(a){d(a)&&e.push(a)});return e}function ma(c,d){return c.replace(ha,function(c,a){return d[a]||c})}function W(c,d){return setTimeout(c,d)}
function P(c){var d="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var a=16*Math.random()|0;return("x"==c?a:a&3|8).toString(16)});c&&c(d);return d}function S(c,d){if(c&&d)if("undefined"!=typeof c[0])for(var e=0,a=c.length;e<a;)d.call(c[e],c[e],e++);else for(e in c)c.hasOwnProperty&&c.hasOwnProperty(e)&&d.call(c[e],e,c[e])}function X(c,d){var e=[];S(c||[],function(a,c){e.push(d(a,c))});return e}function Y(c){var d=[];S(c,function(c,a){a.i&&d.push(c)});return d.sort()}
function na(){W(function(){s||(s=1,S(v,function(c){c()}))},M)}
function oa(c){function d(){}function e(b){if(pa){if(!n.length)return}else{b&&(n.g=0);if(n.g||!n.length)return;n.g=1}w(n.shift())}function a(b){var c=0;S(Y(z),function(a){if(a=z[a])c++,(b||function(){})(a)});return c}function f(){qa()||A(1,{error:"Offline. Please check your network settings. "});setTimeout(f,M)}function y(){t.time(function(b){F(function(){},b);b||A(1,{error:"Heartbeat failed to connect to Pubnub Servers.Please check your network settings."});setTimeout(y,G)})}function A(b,a){H&&H(b,
a);H=null}function F(b,a){function c(a){a&&(T=O()-(a/1E4+(O()-h)/2),b&&b(T))}var h=O();a&&c(a)||t.time(c)}var I=+c.windowing||ca,U=(+c.timeout||da)*M,G=(+c.keepalive||ea)*M,J=c.noleave||0,k=c.publish_key||"demo",h=c.subscribe_key||"demo",p=c.auth_key||"",g=c.secret_key||"",E=c.PNSDK||"",q=c.hmac_SHA256,B=c.ssl?"s":"",N="http"+B+"://"+(c.origin||"pubsub.pubnub.com"),x=Q(N),Z=Q(N),n=[],T=0,$=0,aa=0,H=0,V=0,K=0,z={},pa=c.no_wait_for_pending,w=c.xdr,m=c.error||function(){},qa=c._is_online||function(){return 1},
C=c.jsonp_cb||function(){return 0},L=c.db||{get:function(){},set:function(){}},r=c.uuid||L&&L.get(h+"uuid")||"",t={LEAVE:function(b,a,c,d){var k={uuid:r,auth:p},e=Q(N);c=c||function(){};var g=d||function(){};d=C();if(0<b.indexOf(D))return!0;if(J||!B||"0"==d)return!1;"0"!=d&&(k.callback=d);w({j:a||B,timeout:2E3,a:d,data:k,c:function(b){"object"==typeof b&&b.error?g(b):c(b)},b:g,url:[e,"v2","presence","sub_key",h,"channel",encodeURIComponent(b),"leave"]});return!0},history:function(b,a){a=b.callback||
a;var c=b.count||b.limit||100,d=b.reverse||"false",k=b.error||function(){},e=b.auth_key||p,g=b.channel,l=b.start,R=b.end,f={},q=C();if(!g)return m("Missing Channel");if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");f.stringtoken="true";f.count=c;f.reverse=d;f.auth=e;q&&(f.callback=q);l&&(f.start=l);R&&(f.end=R);w({a:q,data:f,c:function(b){"object"==typeof b&&b.error?k(b):a(b)},b:k,url:[x,"v2","history","sub-key",h,"channel",encodeURIComponent(g)]})},replay:function(b,a){a=
a||b.callback||function(){};var c=b.auth_key||p,d=b.source,e=b.destination,g=b.stop,f=b.start,l=b.end,R=b.reverse,q=b.limit,E=C(),u={};if(!d)return m("Missing Source Channel");if(!e)return m("Missing Destination Channel");if(!k)return m("Missing Publish Key");if(!h)return m("Missing Subscribe Key");"0"!=E&&(u.callback=E);g&&(u.stop="all");R&&(u.reverse="true");f&&(u.start=f);l&&(u.end=l);q&&(u.count=q);u.auth=c;w({a:E,c:function(b){"object"==typeof b&&b.error?err(b):a(b)},b:function(){a([0,"Disconnected"])},
url:[x,"v1","replay",k,h,d,e],data:u})},auth:function(b){p=b;d()},time:function(b){var a=C();w({a:a,data:{uuid:r,auth:p},timeout:5*M,url:[x,"time",a],c:function(a){b(a[0])},b:function(){b(0)}})},publish:function(b,a){a=a||b.callback||function(){};var c=b.message,d=b.channel,g=b.auth_key||p,f=b.error||function(){},q=C(),l="push";b.prepend&&(l="unshift");if(!c)return m("Missing Message");if(!d)return m("Missing Channel");if(!k)return m("Missing Publish Key");if(!h)return m("Missing Subscribe Key");
c=JSON.stringify(c);n[l]({a:q,timeout:5*M,url:[x,"publish",k,h,0,encodeURIComponent(d),q,encodeURIComponent(c)],data:{uuid:r,auth:g},b:function(b){f(b);e(1)},c:function(b){"object"==typeof b&&b.error?f(b):a(b);e(1)}});e()},unsubscribe:function(b,a){var c=b.channel;a=a||b.callback||function(){};var h=b.error||function(){};K=0;V=1;c=X((c.join?c.join(","):""+c).split(","),function(b){if(z[b])return b+","+b+D}).join(",");S(c.split(","),function(b){var c=!0;b&&(s&&(c=t.LEAVE(b,0,a,h)),c||a({action:"leave"}),
z[b]=0)});d()},subscribe:function(b,c){function k(b){b?setTimeout(d,M):(x=Q(N,1),Z=Q(N,1),W(function(){t.time(k)},M));a(function(a){if(b&&a.d)return a.d=0,a.l(a.name);b||a.d||(a.d=1,a.disconnect(a.name))})}function e(){var b=C(),c=Y(z).join(",");c&&(A(),H=w({timeout:F,a:b,b:function(b){n(b);H=null;t.time(k)},data:{uuid:r,auth:f},url:[Z,"subscribe",h,encodeURIComponent(c),b,K],c:function(b){H=null;if(!b||"object"==typeof b&&"error"in b&&b.error)return n(b),setTimeout(d,M);ra(b[1]);K=!K&&V&&L.get(h)||
b[1];a(function(b){b.f||(b.f=1,b.k(b.name))});B&&(K=1E4,B=0);L.set(h,b[1]);var c=function(){var a=(2<b.length?b[2]:X(z,function(a){return X(Array(b[0].length).join(",").split(","),function(){return a})}).join(",")).split(",");return function(){var b=a.shift()||aa;return[(z[b]||{}).a||$,b.split(D)[0]]}}(),k=O()-T-+b[1]/1E4;S(b[0],function(a){var h=c();h[0](a,b,h[1],k)});setTimeout(e,J)}}))}var g=b.channel;c=(c=c||b.callback)||b.message;var f=b.auth_key||p,q=b.connect||function(){},l=b.reconnect||function(){},
E=b.disconnect||function(){},n=b.error||function(){},ra=b.idle||function(){},u=b.presence||0,y=b.noheresync||0,B=b.backfill||0,G=b.timetoken||0,F=b.timeout||U,J=b.windowing||I;V=b.restore;K=G;if(!g)return m("Missing Channel");if(!c)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");S((g.join?g.join(","):""+g).split(","),function(b){var a=z[b]||{};z[aa=b]={name:b,f:a.f,d:a.d,i:1,a:$=c,k:q,disconnect:E,l:l};u&&(t.subscribe({channel:b+D,callback:u}),a.i||y||t.here_now({channel:b,callback:function(a){S("uuids"in
a?a.uuids:[],function(c){u({action:"join",uuid:c,timestamp:O(),occupancy:a.occupancy||1},a,b)})}}))});d=function(){A();setTimeout(e,J)};if(!s)return v.push(d);d()},here_now:function(b,a){a=b.callback||a;var c=b.error||function(){},d=b.auth_key||p,k=b.channel,g=C(),d={uuid:r,auth:d};if(!k)return m("Missing Channel");if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");"0"!=g&&(d.callback=g);w({a:g,data:d,c:function(b){"object"==typeof b&&b.error?c(b):a(b)},b:c,url:[x,"v2","presence",
"sub_key",h,"channel",encodeURIComponent(k)]})},grant:function(b,a){a=b.callback||a;var c=b.error||function(){},d=b.channel,e=C(),f=b.ttl||-1,p=b.read?"1":"0",l=b.write?"1":"0",n=b.auth_key;if(!d)return m("Missing Channel");if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");if(!k)return m("Missing Publish Key");if(!g)return m("Missing Secret Key");var t=Math.floor((new Date).getTime()/1E3),r=q(h+"\n"+k+"\ngrant\n"+(n&&0<encodeURIComponent(n).length?"auth="+encodeURIComponent(n)+
"&":"")+"channel="+encodeURIComponent(d)+"&pnsdk="+encodeURIComponent(E)+"&r="+p+"&timestamp="+encodeURIComponent(t)+(-1<f?"&ttl="+f:"")+"&w="+l,g),r=r.replace(/\+/g,"-"),r=r.replace(/\//g,"_"),d={w:l,r:p,signature:r,channel:encodeURIComponent(d),timestamp:t};"0"!=e&&(d.callback=e);-1<f&&(d.ttl=f);n&&(d.auth=encodeURIComponent(n));w({a:e,data:d,c:function(b){a(b)},b:c,url:[x,"v1","auth","grant","sub-key",h]})},audit:function(b,a){a=b.callback||a;var c=b.error||function(){},d=b.channel,e=b.auth_key,
f=C();if(!a)return m("Missing Callback");if(!h)return m("Missing Subscribe Key");if(!k)return m("Missing Publish Key");if(!g)return m("Missing Secret Key");var p=Math.floor((new Date).getTime()/1E3),l=h+"\n"+k+"\naudit\n";e&&(l+="auth="+encodeURIComponent(e)+"&");d&&(l+="channel="+encodeURIComponent(d)+"&");l+="pnsdk="+encodeURIComponent(E)+"&timestamp="+p;l=q(l,g);l=l.replace(/\+/g,"-");l=l.replace(/\//g,"_");p={signature:l,timestamp:p};"0"!=f&&(p.callback=f);d&&(p.channel=encodeURIComponent(d));
e&&(p.auth=encodeURIComponent(e));w({a:f,data:p,c:function(b){a(b)},b:c,url:[x,"v1","auth","audit","sub-key",h]})},revoke:function(b,a){b.read=!1;b.write=!1;t.grant(b,a)},set_uuid:function(b){r=b;d()},get_uuid:function(){return r},xdr:w,ready:na,db:L,uuid:P,map:X,each:S,"each-channel":a,grep:la,offline:function(){A(1)},supplant:ma,now:O,unique:ia,updater:ka};r||(r=t.uuid());L.set(h+"uuid",r);setTimeout(f,M);setTimeout(y,G);F();return t}
(function(){function c(a){function d(a,c){f||(f=1,clearTimeout(B),g&&(g.onerror=g.onload=null,g.abort&&g.abort(),g=null),a&&x(c))}function e(){if(!q){q=1;clearTimeout(B);try{response=JSON.parse(g.responseText)}catch(a){return d(1)}A(response)}}var g,f=0,q=0,B=W(function(){d(1)},G),y=a.data||{},x=a.b||function(){},A=a.c||function(){},n="undefined"===typeof a.j;try{g="undefined"!==typeof XDomainRequest&&new XDomainRequest||new XMLHttpRequest,g.onerror=g.onabort=function(){d(1,g.responseText||{error:"Network Connection Error"})},
g.onload=g.onloadend=e,g.onreadystatechange=function(){if(4==g.readyState)switch(g.status){case 401:case 402:case 403:try{response=JSON.parse(g.responseText),d(1,response)}catch(a){return d(1,g.responseText)}}},n&&(g.timeout=G),y.pnsdk=U,url=ja(a.url,y),g.open("GET",url,n),g.send()}catch(F){return d(0),c(a)}return d}function d(a,c,d){S(a.split(","),function(a){function e(a){a||(a=window.event);d(a)||(a.cancelBubble=!0,a.returnValue=!1,a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation())}
c.addEventListener?c.addEventListener(a,e,!1):c.attachEvent?c.attachEvent("on"+a,e):c["on"+a]=e})}function e(a){console.error(a)}function a(a,c,d){if(d)a.setAttribute(c,d);else return a&&a.getAttribute&&a.getAttribute(c)}function f(a){return document.getElementById(a)}function y(a,c){var d=[];S(a.split(/\s+/),function(a){S((c||document).getElementsByTagName(a),function(a){d.push(a)})});return d}function A(a,c){for(var d in c)if(c.hasOwnProperty(d))try{a.style[d]=c[d]+(0<"|width|height|top|left|".indexOf(d)&&
"number"==typeof c[d]?"px":"")}catch(e){}}function F(a){return document.createElement(a)}function I(k){k.db=J;k.xdr=c;k.error=e;var h=oa(k);h.init=I;h.$=f;h.attr=a;h.search=y;h.bind=d;h.css=A;h.create=F;d("beforeunload",window,function(){h["each-channel"](function(a){h.LEAVE(a.name,1)});return!0});if(k.notest)return h;d("offline",window,h._reset_offline);d("offline",document,h._reset_offline);h.ready();return h}var U="PubNub-JS-Sencha/3.5.48",G=31E4,J=function(){var a="undefined"!=typeof localStorage&&
localStorage;return{get:function(c){try{return a?a.getItem(c):-1==document.cookie.indexOf(c)?null:((document.cookie||"").match(RegExp(c+"=([^;]+)"))||[])[1]||null}catch(d){}},set:function(c,d){try{if(a)return a.setItem(c,d)&&0;document.cookie=c+"="+d+"; expires=Thu, 1 Aug 2030 20:00:00 UTC; path=/"}catch(e){}}}}();"undefined"!==typeof module&&(module.n=I)||"undefined"!==typeof exports&&(exports.m=I)||(PUBNUB=I)})();
(function(){var c=PUBNUB.ws=function(d,e){if(!(this instanceof c))return new c(d,e);var a=this;d=a.url=d||"";a.protocol=e||"Sec-WebSocket-Protocol";var f=d.split("/"),f={ssl:"wss:"===f[0],origin:f[2],publish_key:f[3],subscribe_key:f[4],channel:f[5]};a.CONNECTING=0;a.OPEN=1;a.CLOSING=2;a.CLOSED=3;a.CLOSE_NORMAL=1E3;a.CLOSE_GOING_AWAY=1001;a.CLOSE_PROTOCOL_ERROR=1002;a.CLOSE_UNSUPPORTED=1003;a.CLOSE_TOO_LARGE=1004;a.CLOSE_NO_STATUS=1005;a.CLOSE_ABNORMAL=1006;a.onclose=a.onerror=a.onmessage=a.onopen=
a.onsend=function(){};a.binaryType="";a.extensions="";a.bufferedAmount=0;a.trasnmitting=!1;a.buffer=[];a.readyState=a.CONNECTING;if(!d)return a.readyState=a.CLOSED,a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!0}),a;a.e=PUBNUB.init(f);a.e.h=f;a.h=f;a.e.subscribe({restore:!1,channel:f.channel,disconnect:a.onerror,reconnect:a.onopen,error:function(){a.onclose({code:a.CLOSE_ABNORMAL,reason:"Missing URL",wasClean:!1})},callback:function(c){a.onmessage({data:c})},connect:function(){a.readyState=
a.OPEN;a.onopen()}})};c.prototype.send=function(c){var e=this;e.e.publish({channel:e.e.h.channel,message:c,callback:function(a){e.onsend({data:a})}})}})();
})();
